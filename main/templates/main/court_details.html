

{% extends "main/base.html" %}

{% load static %}
{% load humanize %}

<!--Anything under block content will be displayed  -->
{% block content %}
{% if user.is_authenticated %}

<div class="row">

 <h1 class="col-12">{{title}}</h1>

<table class="table table-stripped">
    <tr><td><h2>Name: {{court_item.full_name}}</h2></td> <td>Contacts: {{court_item.contacts}}</td></tr>
    <tr><td>Current Balance: <b><i>{{court_item.loan_debt | floatformat:0| intcomma }}</i></b></td>
        
        <td>
            <form method="POST" class="form-inline loan-list-button" 
            action="{% url 'main:index' %}" style="display: inline-block; padding: 0px; margin: 0px;">
                {% csrf_token %}
                <input type="hidden" name="set-loan-id" value="{{court_item.loanID.id}}">
            <button class="btn btn-sm btn-success text-white" >View loan Details</button>
        </form>
    
        </td>    
    
    </tr>
    <tr><td data-target="#edit-form" data-toggle="collapse" style="cursor: pointer;"
         colspan="2">
         <span class="bg-info text-white btn btn-sm"><i class="fa fa-pencil"></i>&nbsp;Edit Details</span>
        </td>

    </tr>
</table>





<div class="col-12">
    <div id="edit-form" class="collapse">
    <form class="row" action=""  method="POST">           
        {% csrf_token %}
        <input type="hidden" name="clientID" value="{{court_item.clientID}}">
        <input type="hidden" name="loanID" value="{{court_item.loanID}}">
        <input type="hidden" name="edit-court-queue" value="edit-court-queue">


    <div class="col-12 col-md-4" >
        <label class="col-12" for="fullname">Full Name</label>
        <input class="col-12" type="text" name="fullname" value="{{court_item.full_name}}">
        <label class="col-12" for="gender">Gender</label>
        <select class="col-12" value="{{gender}}" name="gender" required>
            <option value="M" name="male">Male</option>
            <option value="F" name="female">Female</option>
        </select>

        <label class="col-12" for="nin">NIN</label>
        <input class="col-12" class="col-12" type="text" value="{{court_item.national_identification_number}}" 
        name="nin">
        <label class="col-12" for="contacts">Contacts</label>
        <input class="col-12" type="text" name="contacts" value="{{court_item.contacts}}">

    </div>
    <div class="col-12 col-md-4" >

        <label class="col-12" for="address">Address</label>
        <input class="col-12" type="text" name="address" value="{{court_item.address}}">
        <label class="col-12" for="loan-record-date">Loan Record Date</label>
        <input class="col-12" type="text" name="loan-record-date" value="{{loan_record_date}}">
        <label class="col-12" for="principle">Principle</label>
        <input class="col-12" type="number" name="principle" value="{{court_item.loan_principle}}">
        
        <label class="col-12" for="loan-debt">Current Balance</label>
        <input class="col-12" type="text" name="loan-debt" value="{{court_item.loan_debt}}">
    </div>
       
    <div class="col-12 col-md-4" >
        <div class="row">
            <label class="col-12 bg-success" for="demand-notice">Demand Notice</label>
            <input class="col-12" type="text" name="demand-notice"
             value="{{court_item.demand_notice}}" id="demand-notice" required>
        <label class="col-12" for="details">More Details</label>
        <textarea class="col-12" style="min-height: 150px; height: auto;" name="details">{{court_item.notes}}</textarea>
        <input style="margin-top:5px;" class="btn btn-info btn-white" type="submit" value="Save">
        </div>
    </div>

</form>
</div>

</div>

<div class="col-12">

<h3>Court Transctions Against: {{court_item.full_name}}</h3>
<div class="col-12"> 
    <h4 class="col-12" data-target="#expense" data-toggle="collapse" style="cursor: pointer;">
        <i style="text-align: center; padding: 5px; border:0px solid transparent; border-radius: 100%; width:25px;"
        class="fa fa-plus  bg-info text-white">
        </i> &nbsp;Expense On Client&nbsp;<i class="fa fa-angle-down"></i></h4>
    
        <div id="expense" class="collapse">
            <h3>Expense</h3>  
             <form action="" method="POST" class="row">
                {% csrf_token %}
                <div  class="col-12 col-md-6">
                    <div class="row">
                <input type="hidden" name="cat-name" value="{{item_category_exp}}">
                <input type="hidden" name="add-court-inc-exp" value="add-court-inc-exp">
                <input type="hidden" name="court-exp" value="court-exp">
                <input type="hidden" name="supper-typeID" value="2">  
                <input type="hidden" name="court-id" value="{{court_id}}">   
                <input type="hidden" name="client-name" value="{{court_item.full_name}}">  
               
                <label class="col-12 col-md-11"   for="description">Description</label>
                <textarea class="col-12 col-md-11"  
                name="description" id="description"></textarea>

                <label class="col-12 col-md-11"   for="pay-methodID">Pay Method</label>                  
                <select class="col-12 col-md-11" name="pay-methodID" id="pay-methodID">
                {% for pay_method in get_global_db_objects.pay_methods %}
                    <option value="{{pay_method.id}}">{{pay_method.pay_method_name}}</option>          
                {% endfor %}
                </select> 
            </div> 
            </div>
    
            <div  class="col-12 col-md-6">
             <div class="row">

                <label class="col-12 col-md-11"  for="pay-medium">Pay Medium</label>
                <input class="col-12 col-md-11"   type="text"  name="pay-medium">
                <label class="col-12 col-md-11" for="pay-identification">Pay Identification</label>
                <input class="col-12 col-md-11"  type="text" name="pay-identification">
    
                <label class="col-12 col-md-11"  for="amount">Amount</label>
                <input type="number" class="col-12 col-md-11"  name="amount" id="amount" required>
                <br>
                <div class="col-12 col-md-3">
                <input style="margin-top:3px;" type="Submit" value="Save" class="btn btn-info text-white">
                </div>
            </div>
            </div>
            </form>    
        </div>
    </div>

    <div class="col-12">
        <h4 class="col-12" data-target="#income" data-toggle="collapse" style="cursor: pointer;">
            <i style="text-align: center; padding: 5px; border:0px solid transparent; border-radius: 100%; width:25px;" 
            class="fa fa-plus bg-info text-white">
            </i> &nbsp;Client Payment &nbsp;<i class="fa fa-angle-down"></i></h4>
        
        <div id="income" class="collapse">
            <h3>Payment</h3>
        
            <form action="" method="POST" class="row">
            {% csrf_token %}
                <div class="col-md-6 col-12">
                    <div class="row">
                <input type="hidden" name="add-court-inc-exp" value="add-court-inc-exp">
                <input type="hidden" name="court-inc" value="court-inc">
                <input type="hidden" name="cat-name" value="{{item_category_inc}}">
                <input type="hidden" name="supper-typeID" value="1">
                <input type="hidden" name="court-id" value="{{court_id}}"> 
                <input type="hidden" name="client-name" value="{{court_item.full_name}}"> 

                <label class="col-12 col-md-11"  for="station-id">Station</label>
                <select class="col-12 col-md-11"   name="station-id" id="station">
                    <option  value="0">Choose Station</option>
                    {% for station in get_global_db_objects.stations %}
                        <option value="{{station.id}}">{{station.station_name}}</option>          
                    {% endfor %}
                </select>
                <label class="col-12 col-md-11"  for="descriptioni">Description</label>
                <textarea class="col-12 col-md-11"  name="description" id="descriptioni" required ></textarea>
               
                <label class="col-12 col-md-11"  for="pay-methodID">Pay Method</label>                  
                <select class="col-12 col-md-11"   name="pay-methodID" id="pay-methodID" required>
                {% for pay_method in get_global_db_objects.pay_methods %}
                    <option value="{{pay_method.id}}">{{pay_method.pay_method_name}}</option>          
                {% endfor %}
               </select> 
            </div> 
           </div>
            <div class="col-md-6 col-12">
                <div class="row">
                <label class="col-12 col-md-11"  for="pay-medium">Pay Medium</label>
                <input class="col-12 col-md-11"  type="text"  name="pay-medium">
                <label class="col-12 col-md-11"  for="pay-identification">Pay Identification</label>
                <input class="col-12 col-md-11"  type="text" name="pay-identification">
                <label class="col-12 col-md-11"  for="amount">Amount</label>
                <input type="number" class="col-12 col-md-11"  name="amount" id="amount" required>
                <br>
                <input style="margin-top:3px;" type="Submit" value="Save" class="btn btn-info text-white">
            </div>
           </div>
            </form> 
        
           </div>
        </div>

    <table class="table table-striped table-bordered">
    <thead>
        <tr>
            <td>Record Date</td>
            <td>Description</td>
            <td>Debit</td>
            <td>Credit</td>
        </tr>
    </thead>
    <tbody>
        {% for item in court_payments %}
        <tr>
            
            <td>{{item.record_date}}</td>
            <td>{{item.description}}</td>
            <td>{{item.debit | intcomma }}</td>
            <td>{{item.credit| intcomma }}</td>
        </tr>
        {% endfor %}
    </tbody>

    <tfoot class="bg-dark text-white">
        <tr>
            <td></td>
            <td></td>
            <td colspan="2"> Total Spent : {{total_spent | intcomma }}  Total Paid {{total_paid | intcomma }} 
                Difference: {{client_diff | intcomma }} </td>
        </tr>
    </tfoot>

    </table>
</div>

</div>

{% endif %}
{% endblock %}